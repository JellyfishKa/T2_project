# MVP Demo Checklist — T2 AI Route Optimization

**Дата:** 27 февраля 2026
**Версия:** v1.2.0

---

## 1. Статус компонентов

| Компонент | Статус | Комментарий |
|-----------|--------|-------------|
| **Frontend (Vue 3 + TypeScript)** | ✅ Готов | SPA: Home, Dashboard, Optimize, Analytics, Schedule, Reps |
| **Backend (FastAPI + Python)** | ✅ Готов | 33 эндпоинта реализовано |
| **PostgreSQL** | ✅ Готов | 8 таблиц, миграции, ORM-модели |
| **Redis** | ✅ Готов | Контейнер настроен для кеширования |
| **Docker Compose** | ✅ Готов | Multi-stage builds, 4 сервиса |
| **Nginx** | ✅ Готов | Проксирование API, SPA routing |
| **LLM: Qwen 0.5B** | ✅ Готов | GGUF, pros/cons для вариантов маршрута |
| **LLM: Llama 1B** | ✅ Готов | GGUF, альтернативная модель на выбор |
| **SchedulePlanner** | ✅ Готов | A/B/C/D, MAX 14 ТТ/день, автоперенос skipped |
| **3 варианта маршрута** | ✅ Готов | Greedy / Priority / Balanced + LLM pros/cons |
| **Excel-экспорт** | ✅ Готов | openpyxl, 4 листа: Расписание / Журнал / Статистика / Активность ТП |
| **Автоперенос пропущенных ТТ** | ✅ Готов | skipped → новый визит в ближайший свободный день |
| **Analytics Insights** | ✅ Готов | Охват ТТ, активность ТП, по категориям и районам |

---

## 2. API-эндпоинты

### Оптимизация маршрутов

| Метод | Путь | Описание | Статус |
|-------|------|----------|--------|
| GET | `/health` | Проверка здоровья системы | ✅ |
| POST | `/api/v1/optimize` | Мгновенная оптимизация (чистый greedy, < 100 мс) | ✅ |
| POST | `/api/v1/qwen/optimize` | Прямой вызов Qwen | ✅ |
| POST | `/api/v1/llama/optimize` | Прямой вызов Llama | ✅ |
| POST | `/api/v1/optimize/variants` | 3 варианта маршрута с pros/cons от LLM | ✅ |
| POST | `/api/v1/optimize/confirm` | Сохранение выбранного варианта в БД | ✅ |

### Торговые точки и представители

| Метод | Путь | Описание | Статус |
|-------|------|----------|--------|
| GET | `/api/v1/locations/` | Список всех ТТ | ✅ |
| POST | `/api/v1/locations/` | Создание ТТ | ✅ |
| POST | `/api/v1/locations/upload` | Загрузка из XLSX/CSV/JSON | ✅ |
| GET | `/api/v1/reps` | Список торговых представителей | ✅ |
| POST | `/api/v1/reps` | Создание ТП | ✅ |
| PATCH | `/api/v1/reps/{id}` | Обновление статуса/данных ТП | ✅ |
| DELETE | `/api/v1/reps/{id}` | Удаление ТП | ✅ |

### Расписание и визиты

| Метод | Путь | Описание | Статус |
|-------|------|----------|--------|
| POST | `/api/v1/schedule/generate` | Генерация месячного расписания | ✅ |
| GET | `/api/v1/schedule/` | Расписание на месяц | ✅ |
| GET | `/api/v1/schedule/daily` | Маршруты всех ТП на конкретный день | ✅ |
| GET | `/api/v1/schedule/{rep_id}` | Расписание конкретного ТП | ✅ |
| PATCH | `/api/v1/schedule/{id}` | Обновление статуса визита (skipped → автоперенос) | ✅ |
| POST | `/api/v1/force_majeure` | Регистрация форс-мажора + перераспределение ТТ | ✅ |
| GET | `/api/v1/force_majeure` | История форс-мажоров | ✅ |
| POST | `/api/v1/visits` | Фиксация визита (time_in/time_out) | ✅ |
| GET | `/api/v1/visits/` | История визитов с фильтрами | ✅ |
| GET | `/api/v1/visits/stats` | Статистика посещаемости за месяц | ✅ |

### Аналитика и отчётность

| Метод | Путь | Описание | Статус |
|-------|------|----------|--------|
| GET | `/api/v1/metrics` | Метрики LLM-моделей | ✅ |
| GET | `/api/v1/insights` | Охват ТТ, активность ТП, по районам | ✅ |
| GET | `/api/v1/routes/` | История маршрутов (пагинация) | ✅ |
| GET | `/api/v1/routes/{id}` | Детали маршрута с метриками | ✅ |
| GET | `/api/v1/export/schedule` | Экспорт в Excel: 4 листа с аналитикой | ✅ |
| GET | `/api/v1/benchmark/compare` | Сравнение LLM-моделей | ✅ |
| GET | `/api/v1/benchmark/status` | Статус бенчмарка | ✅ |
| GET | `/api/v1/benchmark/latest` | Последний результат бенчмарка | ✅ |

> **Итого: 33 эндпоинта.**

---

## 3. UI-страницы

| Страница | Маршрут | Статус | Ключевые возможности |
|----------|---------|--------|----------------------|
| **Home** | `/` | ✅ | Лендинг, навигация, описание платформы |
| **Dashboard** | `/dashboard` | ✅ | Статистика, метрики, история маршрутов |
| **Optimize** | `/optimize` | ✅ | Выбор модели (Qwen/Llama), прогресс-бар ожидания, **3 варианта с pros/cons**, сохранение |
| **Analytics** | `/analytics` | ✅ | Графики, охват ТТ по категориям A/B/C/D, активность ТП, кнопка Excel |
| **Schedule** | `/schedule` | ✅ | Месячный план, Day modal, спиннер оптимизации, **кнопка Excel-экспорта** |
| **Reps** | `/reps` | ✅ | CRUD торговых представителей, управление статусами |

---

## 4. Архитектура оптимизации маршрутов

```
Пользователь нажимает «Оптимизировать»
    ↓
POST /api/v1/optimize/variants
    ↓
Бэкенд за < 1 сек вычисляет 3 варианта:
  Вариант 1: Greedy (минимум расстояния)
  Вариант 2: Priority-first (A→B→C→D)
  Вариант 3: Balanced (60% расстояние + 40% приоритет)
    ↓
LLM (Qwen или Llama) генерирует pros/cons
для каждого варианта (30-120 сек, graceful fallback)
    ↓
Прогресс-бар показывает шаги до ответа
    ↓
Пользователь видит 3 карточки с метриками и LLM-оценкой
    ↓
Выбирает вариант → POST /api/v1/optimize/confirm → сохранение в БД
```

---

## 5. Известные ограничения

| # | Ограничение | Workaround |
|---|-------------|------------|
| 1 | Первый запрос к LLM занимает 5-15 сек (загрузка модели) | Прогресс-бар отображает этап «Загрузка модели» |
| 2 | Qwen 0.5B / Llama 1B — небольшие модели, иногда не генерируют pros/cons | Варианты всегда показываются с метриками, LLM — дополнение |
| 3 | `/optimize/variants` timeout = 180 сек | При зависании фронт покажет ошибку с кнопкой «Повторить» |
| 4 | CORS по умолчанию — только localhost и 100.120.184.98 | При смене IP обновить `CORS_ORIGINS` в `.env` |
| 5 | LLM не участвует в `POST /optimize` (чистый greedy) | Для LLM-функций использовать `/optimize/variants` |

---

## 6. Pre-Demo Checklist

### За день до демо

- [ ] Подключиться к серверу: `ssh jellyfishka@100.120.184.98`
- [ ] `cd ~/T2_project && git pull` — последняя версия кода
- [ ] Проверить наличие GGUF-моделей: `ls -lh backend/src/models/*.gguf`
- [ ] Проверить `.env` файл
- [ ] `docker compose build` — пересобрать образы если были изменения
- [ ] Загрузить тестовые данные: 250+ ТТ Мордовии через `POST /api/v1/locations/upload`
- [ ] Создать торговых представителей: минимум 3 человека через `/reps`
- [ ] Сгенерировать расписание: `POST /api/v1/schedule/generate` для текущего месяца

### За 30 минут до демо

- [ ] `docker compose up -d` — все сервисы запущены
- [ ] `docker compose ps` — все контейнеры в статусе "Up"
- [ ] `curl http://localhost:8000/health` → `{"status": "healthy"}`
- [ ] Открыть `http://localhost` — фронтенд загружается без ошибок
- [ ] Открыть `/analytics` — данные инсайтов отображаются (охват ТТ, активность ТП)
- [ ] **Прогрев LLM:** открыть `/optimize`, создать маршрут из 3 ТТ с моделью Qwen — дождаться вариантов
- [ ] Убедиться что 3 варианта отображаются с карточками и метриками
- [ ] Открыть `/schedule` — убедиться что Calendar отрисовывается с данными
- [ ] **Тест Excel:** нажать кнопку «Excel» в Schedule — файл скачивается, 4 листа корректны
- [ ] `docker compose logs -f backend` — нет критических ошибок

### Во время демо

- [ ] Держать открытым терминал с `docker compose logs -f backend`
- [ ] Swagger UI открыт в отдельной вкладке: `http://100.120.184.98:8000/docs`
- [ ] Фронтенд открыт на Home-странице
- [ ] Заготовить Excel-файл для демонстрации импорта

### Рекомендуемый сценарий демо

1. **Home** → описание платформы и задача T2
2. **Optimize** → загрузить 5-8 ТТ, выбрать модель Qwen, нажать «Оптимизировать»
   - Прогресс-бар: показать 4 этапа работы системы
   - Показать 3 варианта с метриками и LLM-комментариями
   - Выбрать вариант → «Применить» → сохранение
3. **Schedule** → открыть месяц, кликнуть на день → Day modal
   - Показать список ТТ с категориями A/B/C/D
   - Нажать «Оптимизировать маршрут (ИИ)» → спиннер → результат за < 1 сек
   - Зарегистрировать форс-мажор (болезнь ТП) → автоперераспределение
   - Скачать Excel-отчёт → открыть 4 листа
4. **Reps** → показать список ТП, управление статусами
5. **Analytics** → охват по категориям, активность ТП, кнопка «Скачать Excel»
6. **Dashboard** → общая статистика маршрутов

---

## 7. Контакты для экстренных ситуаций

| Роль | Имя | Контакт |
|------|-----|---------|
| TL / PM | Сергей Маклаков | @maklakov_tkdrm |
| Backend | Роман Кижаев | [TBD] |
| Frontend | Владислав Наумкин | [TBD] |
| ML / Analytics | Дмитрий Мукасеев | [TBD] |

---

*См. также: [MVP_RELEASE_NOTES.md](MVP_RELEASE_NOTES.md) · [DEPLOYMENT_GUIDE.md](../SERVER/DEPLOYMENT_GUIDE.md) · [API_CONTRACT.md](../API_CONTRACT.md)*
